<html>
<head>
<title>Sky</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8'">
<link rel="stylesheet" type="text/css" href="style.css">
<!-- include jquery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="colormix.js"></script>
<!-- place 4 images in a grid with fixed positions'-->

<!-- now for the javascript -->
</head>
<body>
<div id="sky">
  <img id='1' style="position:fixed;left:700px;top:50px" src='cloud1.png'/>
  <img id='2' style="position:fixed;left:300px;top:0px" src='cloud2.png'/>
  <img id='3' style="position:fixed;left:300px;top:100px" src='cloud3.png'/>
  <img id='4' style="position:fixed;left:700px;top:0px" src='cloud4.png'/>
  <img id='5' style="position:fixed;left:0px;top:0px" src='cloud5.png'/>
  
</div>
<div id="bird"></div>
<div id="waves"></div>
<div id="cloud"></div>
<div id="rain"></div>
</body>
</html>
<script>

getGradientColor = function(start_color, end_color, percent) {
  var start = new ColorMix.Color(start_color)
  var end = new ColorMix.Color(end_color)
  percent = percent*100
  console.log("percent:"+percent)
  return ColorMix.mix([start,end],[percent,100-percent])
 };

functions_json = {"functions":[
  {"start":0,"end":24,"function":"skyfade"},
  {"start":13.5,"end":14,"function":"fade2"}
]}

sky_json = {"sky":[
  [0,"#000818"],
  [5.5,"#000818"],
  [7,"#0C77e8"],
  [12,"#00BFFF"],
  [14,"#00BFFF"],
  [19,"#0099cc"],
  [21,"#000818"],
  [24,"#000818"]
]}

function skyfade(ft)
{
  console.log("skyfade with time:"+ft)  
  colortimes = sky_json["sky"]
  for (var i=0;i<colortimes.length-1;++i) {
    colortime = colortimes[i]
    next_colortime = colortimes[i+1]
    start_time = colortime[0]
    end_time = next_colortime[0]
    if (ft>start_time) {
      start_color=colortime[1]
      end_color= next_colortime[1]
      ratio = (ft-start_time)/(end_time-start_time)
      console.log(start_time+":"+end_time+":"+ratio)
      color = getGradientColor(start_color,end_color,ratio)
      console.log("gradient color:"+color)
      $("#sky").css("background-color",color)
    }
  }
   
}

function fade2()
{
  console.log("fade2")  
}

function fraction_time()
{
  d = new Date()
  h = d.getHours()
  s = ((d.getMinutes()*60)+d.getSeconds()+1.0)/3600.0
  return h+s
}

function tick()
{
  ft = fraction_time()
  console.log("tick:"+ ft)
  ranges = functions_json["functions"]
  for (var i=0;i<ranges.length;++i) {
    range = ranges[i]
    if (ft>= range["start"] && ft< range["end"]) {
      eval(range["function"]+"("+ft+")")
    }
  }
}
setInterval(tick,1000)

// setting up some functions to use
function hide(id) {
  $("#"+id).hide()
}

function fadeIn(id,duration) {
  $("#"+id).fadeIn(duration)
}

function fadeOut(id,duration) {
  $("#"+id).fadeOut(duration)
}
// now we get started here. first, hide all the images.
hide('1');
hide('2');
hide('3');
hide('4');
hide('5');

// now fade in image 1 after 2 seconds (2000 milliseconds)
setTimeout(function() { 
  fadeIn(1,1000)
}, 2000);

setTimeout(function() { 
  fadeIn(2,1000)
}, 4000);

setTimeout(function() { 
  fadeIn(3,1000)
}, 6000);

setTimeout(function() { 
  fadeIn(4,1000)
}, 8000);

setTimeout(function() { 
  fadeIn(5,1000)
}, 10000);
</script>

